import machine
from machine import Pin, I2C

# I2C address of the VL6180X sensor
SENSOR_I2C_ADDR = 0x29

# Configure I2C communication
i2c = I2C(0, scl=machine.Pin(1), sda=machine.Pin(0), freq=100000)
i2c.start()

# Initialize the VL6180X sensor
i2c.writeto(SENSOR_I2C_ADDR, bytes([0x015, 0x01]))  # Reset sensor
machine.idle()  # Give it some time to reset
i2c.writeto(SENSOR_I2C_ADDR, bytes([0x016, 0x02]))  # Set ALS integration period

try:
    while True:
        # Trigger a range measurement
        i2c.writeto(SENSOR_I2C_ADDR, bytes([0x018, 0x01]))

        # Wait for the measurement to complete (adjust the delay as needed)
        machine.sleep(100)

        # Read distance measurement (in millimeters)
        data = i2c.readfrom(SENSOR_I2C_ADDR, 12)
        distance = (data[10] << 8) | data[11]

        print("Distance: {} mm".format(distance))
        
except KeyboardInterrupt:
    pass

